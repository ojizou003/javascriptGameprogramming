2023/8/9
# 「JavaScriptゲームプログラミング 知っておきたい数学と物理の基本」  田中賢一郎

【概要】
## 基礎編
* 速度・加速度
* 三角関数
* ベクトル
* 行列

## 2D編
* 画像処理ソフト
* 簡易物理エンジンの実装(Tiny2D.js)

## 3D編
* 座標→ワイヤーフレーム→面→テクスチャマッピング
* 簡易3Dビューワの実装
* 3Dゲームの作成

---

## 速度
- 速度 = 一定時間に進む距離
- 距離 = 速度 * 時間
- setInterval(メイン処理の関数,関数を呼び出す間隔(msec));
- [一定速度で右方向へ移動するサンプル](./speed0.html)
- posX += velocityX;
- setInterval(tick,100);
- 速度をX方向とY方向に分割すると斜めにも移動できる
- [矩形を斜めに移動するサンプル](./speed1.html)

## 加速度
- [加速度のサンプル](./speed2.html)
- velocityX += accelX;
- posX += velocityX;

## 重力加速度
- 重力加速度 = 9.80665m/s^2
- [重力加速度的サンプル](./speed3.html)
- [重力加速度を使ったシンプルなゲーム](./speed4.html)
- velocityY += isFlying ? -accelY : accelY;
- ↑３項演算子。isFlyingがtrueのときは-accelY、falseのときはaccelYをvelocityYに加算する

## 三角関数
- 任意の場所を表現する方法にはX-Y座標系のほかに極座標系がある
- 極座標系では中心からの距離(r)と角度(Θ)で任意の場所を表現する
- canvasではrとΘで場所を指定することができない→三角関数を使う
- 角度Θが決まると、cosΘでX、sinΘでYを求めることができる
- [中心角とsin/cosの値を表示するページ](./trigFunction0.html)
- 角度とラジアン
- 360° = 2π(ラジアン)
- ° = degree*Math.PI/180
- サイン、コサインカーブ
- [サインコサインカーブのアニメーション](./trigFunction1.html)
- [サインカーブ(ラジアン単位2周分)](./trigFunction2.html)
- [サインカーブ(ラジアン単位2周分)ver.2](./trigFunction3.html)
- [波に浮かぶボート](./trig-boatOnWaves.html)
- [静かに降っている雪](./trig-snow.html)

## ベクトル
- ベクトルとは、向きと大きさを持った量
  - c.f. スカラー・・・1つの数値だけで表される量
- 2次元の座標系におけるベクトルは「xの増分、yの増分」として」表される
- ベクトルの加算
  - (1,2)+(3,1)=(4,3)
  - [ベクトルの加算](./vector-add.html)
- ベクトルの掛け算
  - (2,1)*2=(4,2)
  - (2,1)*0.5=(1,0.5)
  - ベクトルの正規化・・・向きはそのままで、長さを1にすること
  - 長さが1のベクトルを単位ベクトルと呼ぶ
  - [ベクトルをn倍するサンプル](./vector-mul.html)
- ベクトルの内積
  - ベクトルの内積は・で表す
  - v1・v2 = (v1のx) * (v2のx) + (v1のy) * (v2のy)
  - その値はスカラー値になる
  - v1・v2 = |v1| * |v2| * cosΘ
  - [ベクトルの内積から角度を計算するサンプル](./vector-dot.html)
- ベクトルの外積
  - ベクトルの外積は * で表します
  - v1 * v2 = (v1のx) * (v2のy) - (v1のy) * (v2のx)
  - v1 * v2 = |v1| * |v2| * sinΘ
  - [ベクトルの外積から角度を計算するサンプル](./vector-cross.html)
- 行列としてのベクトル

## 行列
- 連立一次方程式
- y=ax+b
- y=cx+d  連立方程式を解くと２つの直線の交点(x,y)を求めることができる
- 2行2列*2行2列の解
  - 1行1列目  最初の行列の1行目と2つ目の行列の1列目をそれぞれ掛けて足す
  - 1行2列目  最初の行列の1行目と2つ目の行列の2列目をそれぞれ掛けて足す
  - 2行1列目  最初の行列の2行目と2つ目の行列の1列目をそれぞれ掛けて足す
  - 2行2列目  最初の行列の2行目と2つ目の行列の2列目をそれぞれ掛けて足す
- 行列の足し算
  - 同じ場所の値を足すだけ
- [行列の掛け算と足し算計算機](./matrix0.html)
- 単位行列
  - 対角線が1、それ以外が0の行列・・・掛け合わせても値が変化しない
- 拡大・縮小・・・行列の掛け算
- 平行移動・・・行列の足し算
- 回転行列
  - cosΘ  -sinΘ
  - sinΘ  cosΘ
- [回転行列を使った画像の回転](./matrix0.html)
- 3Dの行列
- 掛け算、足し算、回転(x軸、y軸、z軸)

## 画像処理
- [canvasに画像を描画](./ImageProcess00-drawpic.html)
- let src = context.getImageData(sx,sy,sw,sh);
- sx,sy..画像の左上の座標、sw,sh..画像の幅と高さ
- (x,y)にアクセスするためには、let i = (y * width + x) * 4
- 4倍しているのは、1ピクセルににつてR,G,B,Aと4バイトのデータが格納されているから
- canvasを使ったラスタデータの取得と描画
- [canvasに画像を表示するサンプル](./imageProcess02-drawraster.html)
- ネガ・ポジ反転
- ^0xff...元の値から反転
- ^..排他的論理和を計算
- 0xff..1111 1111
- グレースケール(白黒)
- 輝度調整
- ノイズ
- 変形(波1)..サインカーブ
- 変形(波2)、(波3)
- エッジ検出
- エンボス加工
- ぼかし
- モザイク
- 回転
- 波紋

## 物理エンジン
- 物理エンジンで計算すること
  - オブジェクトの位置計算(速度・加速度・摩擦・重力・回転など)
  - 衝突判定
  - 衝突時の処理(反発係数・重力・エネルギー保存則など)
- 衝突判定
  - 円と円との衝突判定..三平方の定理を使う
  - 円と矩形の衝突判定
  - 移動する円と線の衝突判定
- 衝突時の処理
  - 動く円と静止円の衝突
  - 動く円と動く円の衝突
- 物理エンジンのコード
  - [円・矩形・線のみのシンプルな2D物理エンジンコード](./tiny2d.js)
  - [2D物理エンジン使用例](./demo2d.html)
  
## 3D 簡易VRMLビューワ
- Virtual Reality Modeling Language..3Dモデルを記述するための言語
- [立方体を表現](./cube.wrl)
- [VRMLファイルを読み込んでpointとcoordIndex情報を抽出するサンプル](./file-API1.html)
- ドットビューワ
- ワイヤーフレームビューワ
- 行列を使って３Dモデルを回転
- 面の塗りつぶし
  - 面の明るさの計算

## 3Dゲームサンプル
- ブロック崩し
- 迷路
- ボール転がし
- ピン当て
- 戦車
- テクスチャマッピング..ポリゴンに画像を張り付ける